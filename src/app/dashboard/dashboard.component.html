<br>
<br>
<button *ngIf="formCloseOrOpens==true" class="btn btn-secondary" (click)="formCloseOrOpen(true)"> Hide Form</button>
<button *ngIf="formCloseOrOpens==false" class="btn btn-secondary" (click)="formCloseOrOpen(false)">Add User</button>

<div *ngIf="isEditEnabled==false" class="col-md-6 offset-md-3 mt-5">

    <div *ngIf="formCloseOrOpens==true" class="card">
        <h4 class="card-header">Add New User</h4>

        <div class="card-body">
            <form [formGroup]="newUserForm" (ngSubmit)="onSubmit()">
                <div class="form-group">
                    <label for="id">ID *</label>
                    <input type="text" formControlName="id" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.id.errors }" />
                    <!-- <div *ngIf="submitted && f.id.errors" class="invalid-feedback">
                        <div *ngIf="f.id.errors.required">ID is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.id.touched || submitted) && f.id.errors?.required">
                        ID is required
                    </span>
                    <span class="text-danger" *ngIf="f.id.errors?.pattern">
                        ID is not Valid
                    </span>
                </div>
                <div class="form-group">
                    <label for="firstName">First name *</label>
                    <input type="text" formControlName="firstName" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.firstName.errors }" />
                    <!-- <div *ngIf="submitted && f.firstName.errors" class="invalid-feedback">
                        <div *ngIf="f.firstName.errors.required">First name is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.firstName.touched || submitted) && f.firstName.errors?.required">
                        First Name is required
                    </span>
                    <span class="text-danger" *ngIf="f.firstName.errors?.pattern">
                        First Name is not Valid
                    </span>

                </div>
                <div class="form-group">
                    <label for="lastName">Last name *</label>
                    <input type="text" formControlName="lastName" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.lastName.errors }" />
                    <!-- <div *ngIf="submitted && f.lastName.errors" class="invalid-feedback">
                        <div *ngIf="f.lastName.errors.required">Last name is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.lastName.touched || submitted) && f.lastName.errors?.required">
                        Last Name is required
                    </span>

                    <span class="text-danger" *ngIf="f.lastName.errors?.pattern">
                        Last Name is not Valid
                    </span>

                </div>
                <div class="form-group">
                    <label for="userName">User name *</label>
                    <input type="text" formControlName="userName" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.userName.errors }" />
                    <!-- <div *ngIf="submitted && f.userName.errors" class="invalid-feedback">
                        <div *ngIf="f.userName.errors.required">Last name is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.userName.touched || submitted) && f.userName.errors?.required">
                        User Name is required
                    </span>
                    <span class="text-danger" *ngIf="f.userName.errors?.pattern">
                        User Name is not Valid
                    </span>


                </div>
                <div class="form-group">
                    <label for="email">Email *</label>
                    <input type="text" formControlName="email" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.email.errors }" />
                    <!-- <div *ngIf="submitted && f.email.errors" class="invalid-feedback">
                        <div *ngIf="f.email.errors.required">Email is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.email.touched || submitted) && f.email.errors?.required">
                                Email is required
                            </span>
                    <div class="text-danger" *ngIf="f.email.errors?.pattern">
                        Email is not valid.
                    </div>
                </div>
                <div class="form-group">
                    <label for="address">Address *</label>
                    <input type="text" formControlName="address" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.address.errors }" />
                    <!-- <div *ngIf="submitted && f.address.errors" class="invalid-feedback">
                        <div *ngIf="f.address.errors.required">Address is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.address.touched || submitted) && f.address.errors?.required">
                                Address is required
                            </span>
                    <span class="text-danger" *ngIf="f.address.errors?.pattern">
                        Address is not Valid
                            </span>
                </div>
                <div class="form-group">
                    <label for="pincode">Pincode *</label>
                    <input type="text" formControlName="pincode" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.pincode.errors }" />
                    <!-- <div *ngIf="submitted && f.pincode.errors" class="invalid-feedback">
                        <div *ngIf="f.pincode.errors.required">pincode is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.pincode.touched || submitted) && f.pincode.errors?.required">
                        Pincode is required
                            </span>
                    <span class="text-danger" *ngIf="f.pincode.errors?.pattern">
                                Pincode is not Valid
                            </span>
                </div>
                <div class="form-group">
                    <label for="phone">Phone Number *</label>
                    <input type="text" formControlName="phone" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.phone.errors }" />
                    <!-- <div *ngIf="submitted && f.phone.errors" class="invalid-feedback">
                        <div *ngIf="f.phone.errors.required">Phone is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.phone.touched || submitted) && f.phone.errors?.required">
                        Phone is required
                            </span>
                    <span class="text-danger" *ngIf="f.phone.errors?.pattern">
                                Phone Number is not Valid
                            </span>
                </div>

                <div>
                    <button [disabled]="loading" class="btn btn-primary">
                    <!-- <span *ngIf="loading " class="spinner-border spinner-border-sm mr-1"></span> -->
                    Add User
                </button> |

                    <button [disabled]="loading" (click)="reset()" class="btn btn-secondary">
                    <span *ngIf="loading " class="spinner-border spinner-border-sm mr-1"></span>
                    Reset
                </button>

                </div>
                <div *ngIf="error" class="alert alert-danger mt-3 mb-0">{{error}}</div>
            </form>
        </div>
    </div>
</div>
<div *ngIf="isEditEnabled==true">
    <div class="card">
        <h4 class="card-header">Edit User Details</h4>
        <div class="card-body">
            <form [formGroup]="newUserForm" (ngSubmit)="onSubmit()">
                <div class="form-group">
                    <label for="id">ID *</label>
                    <input type="text" formControlName="id" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.id.errors }" />
                    <!-- <div *ngIf="submitted && f.id.errors" class="invalid-feedback">
                        <div *ngIf="f.id.errors.required">ID is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.id.touched || submitted) && f.id.errors?.required">
                        ID is required
                    </span>
                    <span class="text-danger" *ngIf="f.id.errors?.pattern">
                        ID is not Valid
                    </span>
                </div>
                <div class="form-group">
                    <label for="firstName">First name *</label>
                    <input type="text" formControlName="firstName" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.firstName.errors }" />
                    <!-- <div *ngIf="submitted && f.firstName.errors" class="invalid-feedback">
                        <div *ngIf="f.firstName.errors.required">First name is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.firstName.touched || submitted) && f.firstName.errors?.required">
                        First Name is required
                    </span>
                    <span class="text-danger" *ngIf="f.firstName.errors?.pattern">
                        First Name is not Valid
                    </span>

                </div>
                <div class="form-group">
                    <label for="lastName">Last name *</label>
                    <input type="text" formControlName="lastName" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.lastName.errors }" />
                    <!-- <div *ngIf="submitted && f.lastName.errors" class="invalid-feedback">
                        <div *ngIf="f.lastName.errors.required">Last name is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.lastName.touched || submitted) && f.lastName.errors?.required">
                        Last Name is required
                    </span>

                    <span class="text-danger" *ngIf="f.lastName.errors?.pattern">
                        Last Name is not Valid
                    </span>

                </div>
                <div class="form-group">
                    <label for="userName">User name *</label>
                    <input type="text" formControlName="userName" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.userName.errors }" />
                    <!-- <div *ngIf="submitted && f.userName.errors" class="invalid-feedback">
                        <div *ngIf="f.userName.errors.required">Last name is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.userName.touched || submitted) && f.userName.errors?.required">
                        User Name is required
                    </span>
                    <span class="text-danger" *ngIf="f.userName.errors?.pattern">
                        User Name is not Valid
                    </span>


                </div>
                <div class="form-group">
                    <label for="email">Email *</label>
                    <input type="text" formControlName="email" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.email.errors }" />
                    <!-- <div *ngIf="submitted && f.email.errors" class="invalid-feedback">
                        <div *ngIf="f.email.errors.required">Email is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.email.touched || submitted) && f.email.errors?.required">
                                Email is required
                            </span>
                    <div class="text-danger" *ngIf="f.email.errors?.pattern">
                        Email is not valid.
                    </div>
                </div>
                <div class="form-group">
                    <label for="address">Address *</label>
                    <input type="text" formControlName="address" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.address.errors }" />
                    <!-- <div *ngIf="submitted && f.address.errors" class="invalid-feedback">
                        <div *ngIf="f.address.errors.required">Address is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.address.touched || submitted) && f.address.errors?.required">
                                Address is required
                            </span>
                    <span class="text-danger" *ngIf="f.address.errors?.pattern">
                        Address is not Valid
                            </span>
                </div>
                <div class="form-group">
                    <label for="pincode">Pincode *</label>
                    <input type="text" formControlName="pincode" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.pincode.errors }" />
                    <!-- <div *ngIf="submitted && f.pincode.errors" class="invalid-feedback">
                        <div *ngIf="f.pincode.errors.required">pincode is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.pincode.touched || submitted) && f.pincode.errors?.required">
                        Pincode is required
                            </span>
                    <span class="text-danger" *ngIf="f.pincode.errors?.pattern">
                                Pincode is not Valid
                            </span>
                </div>
                <div class="form-group">
                    <label for="phone">Phone Number *</label>
                    <input type="text" formControlName="phone" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.phone.errors }" />
                    <!-- <div *ngIf="submitted && f.phone.errors" class="invalid-feedback">
                        <div *ngIf="f.phone.errors.required">Phone is required</div>
                    </div> -->
                    <span class="text-danger" *ngIf="(f.phone.touched || submitted) && f.phone.errors?.required">
                        Phone is required
                            </span>
                    <span class="text-danger" *ngIf="f.phone.errors?.pattern">
                                Phone Number is not Valid
                            </span>
                </div>

                <div>
                    <button [disabled]="loading" class="btn btn-primary">
                        <!-- <span *ngIf="loading " class="spinner-border spinner-border-sm mr-1"></span> -->
                        Update User
                    </button> |
                    <button (click)="isEditCancel()" class="btn btn-secondary">Cancel</button>
                </div>

                <div *ngIf="error" class="alert alert-danger mt-3 mb-0">{{error}}</div>
            </form>
        </div>
    </div>

</div>

<br>
<br>
<p style="text-align: center;">List of Users</p>
<div class="">
    <paging-controls [isItemsPerPage]="true"></paging-controls>
</div>
<div class="list">

    <table class="table ">
        <tr>
            <th>ID</th>
            <th>Full Name</th>
            <th>username</th>
            <th>E-Mail</th>
            <th>Options</th>
        </tr>


        <tr *ngFor="let item of collection | paginate: { currentPage: p} ">
            <td>{{item.id}}</td>
            <td>{{item.firstName}} {{item.lastName}}</td>
            <td>{{item.userName}}</td>
            <td>{{item.email}}</td>
            <td><button class="btn btn-primary" [routerLink]="['/dashboard/', item.id]">View Details</button> | <button class="btn btn-warning" (click)="edit(item.id)">Edit</button> | <button class="btn btn-danger" (click)="delete(item.id) ">Delete</button></td>
        </tr>
    </table>


    <paging-controls (pageChange)="p=$event" [isItemsPerPage]="false"></paging-controls>
</div>